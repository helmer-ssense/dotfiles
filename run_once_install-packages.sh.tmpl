#!/bin/bash

function exist() {
  command -v "$1" >/dev/null 2>&1
}

function install_omz() {
  if ! [ -d ~/.oh-my-zsh ]; then
      sh -c "$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)" "" --unattended --keep-zshrc
  fi
}

cd $HOME/.nerd-fonts
if [ "$(id -u)" -ne 0 ]; then
  sudo ./install.sh
else
  ./install.sh
fi
cd $HOME

{{- if eq .chezmoi.os "linux" }}
{{-   if (or (eq .chezmoi.osRelease.id "ubuntu") (eq .chezmoi.osRelease.id "linuxmint")) }}
if ! exist diff-so-fancy; then
  sudo add-apt-repository -y ppa:aos1/diff-so-fancy
fi

sudo apt update -y

if ! exist zsh; then
  sudo apt install -y zsh --quiet
fi

install_omz

if ! exist ripgrep; then
  sudo apt install -y ripgrep
fi

if ! exist tmux; then
  sudo apt install -y tmux
fi

if ! exist diff-so-fancy; then
  sudo apt install -y diff-so-fancy
fi

if ! exist ag; then
  sudo apt install -y silversearcher-ag
fi

if ! exist wget; then
  sudo apt install -y wget
fi

if ! exist bat; then
  sudo apt install -y bat
fi

curl -sS https://starship.rs/install.sh | sh -s -- -y
{{-   else if eq .chezmoi.osRelease.id "fedora" }}

if ! exist zsh; then
  sudo dnf install -y zsh --quiet
fi

install_omz

if ! exist diff-so-fancy; then
  sudo dnf install -y diff-so-fancy
fi

if ! exist ripgrep; then
  sudo dnf install -y ripgrep
fi

if ! exist tmux; then
  sudo dnf install -y tmux
fi

if ! exist ag; then
  sudo dnf install -y the_silver_searcher
fi

if ! exist wget; then
  sudo dnf install -y wget
fi

if ! exist bat; then
  sudo dnf install -y bat
fi
{{-   end }}
{{- else }}
echo "Your operating system is not a Linux environment"
{{- end }}
